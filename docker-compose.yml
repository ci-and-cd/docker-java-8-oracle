
version: '2.1'
services:
  #docker-compose build image
  image:
    build:
      context: image
      dockerfile: Dockerfile
      args:
      - IMAGE_ARG_FILESERVER=${IMAGE_ARG_FILESERVER:-http://o9wbz99tz.bkt.clouddn.com}
      - IMAGE_ARG_JAVA8_VERSION_MINOR=${IMAGE_ARG_JAVA8_VERSION_MINOR:-171}
      - IMAGE_ARG_JAVA8_VERSION_BUILD=${IMAGE_ARG_JAVA8_VERSION_BUILD:-11}
      - IMAGE_ARG_JAVA8_PACKAGE_DIGEST=${IMAGE_ARG_JAVA8_PACKAGE_DIGEST:-512cd62ec5174c3487ac17c61aaa89e8}
    image: ${IMAGE_PREFIX:-cirepo}/${IMAGE_NAME:-java-8-oracle}:${IMAGE_TAG:-8u171}
  #docker-compose build dumper
  dumper:
    build:
      context: dumper
      dockerfile: Dockerfile_dumper
    image: tmp/dumper:latest
  #docker-compose build archive
  archive:
    build:
      context: .
      dockerfile: Dockerfile_archive
    image: ${IMAGE_PREFIX:-cirepo}/${IMAGE_NAME:-java-8-oracle}:${IMAGE_TAG:-8u171}-archive
